{"remainingRequest":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/src/views/Mafia.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/src/views/Mafia.vue","mtime":1576672475728},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBNYWZpYUNpdGl6ZW4gZnJvbSAiLi4vY29tcG9uZW50cy9NYWZpYUNpdGl6ZW4iOwppbXBvcnQgU29ja0pTIGZyb20gInNvY2tqcy1jbGllbnQiOwppbXBvcnQgU3RvbXAgZnJvbSAid2Vic3RvbXAtY2xpZW50IjsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdNYWZpYScsCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgTWFmaWFDaXRpemVuLAogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBtZXNzYWdlVGVtcGxhdGUobWFmaWFDaGF0TWVzc2FnZSkgewogICAgICAgICAgICBpZihtYWZpYUNoYXRNZXNzYWdlLnVzZXJJZCA9PT0gdGhpcy51c2VySWQpewogICAgICAgICAgICAgICAgcmV0dXJuIGA8ZGl2IGlkPSJtZXNzYWdlIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQiPgogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj7rgpg6ICR7bWFmaWFDaGF0TWVzc2FnZS5tZXNzYWdlfTwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGA8ZGl2IGlkPSJtZXNzYWdlIiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPiR7bWFmaWFDaGF0TWVzc2FnZS5uYW1lfTogJHttYWZpYUNoYXRNZXNzYWdlLm1lc3NhZ2V9PC9zcGFuPgogICAgICAgICAgICAgICAgPC9kaXY+YAogICAgICAgIH0sCiAgICAgIHNlbmRNZXNzYWdlOiBmdW5jdGlvbigpIHsKICAgICAgICAgIGNvbnN0IGdhbWUgPSB0aGlzOwogICAgICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlLWNvbnRlbnQiKS52YWx1ZTsKICAgICAgICAgIGdhbWUuY2xpZW50LnNlbmQoJy9hcHAvcm9vbXMvJyArIHRoaXMucm9vbUlkICsgJy9tYWZpYS9jaGF0JywgY29udGVudCk7CiAgICAgICAgICBpZiAoY29udGVudC5sZW5ndGggIT0gMCkgewogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlLWNvbnRlbnQiKS52YWx1ZSA9ICIiOwogICAgICAgICAgfQogICAgICB9LAogICAgICBhZGRNZXNzYWdlOiBmdW5jdGlvbihtYWZpYUNoYXRNZXNzYWdlKSB7CiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VBcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1lc3NhZ2UtYXJlYSIpOwogICAgICAgICAgICBtZXNzYWdlQXJlYS5pbnNlcnRBZGphY2VudEhUTUwoImJlZm9yZWVuZCIsIHRoaXMubWVzc2FnZVRlbXBsYXRlKG1hZmlhQ2hhdE1lc3NhZ2UpKTsKICAgICAgICAgICAgbWVzc2FnZUFyZWEuc2Nyb2xsVG9wID0gbWVzc2FnZUFyZWEuc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgfQogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY2l0aXplbnM6IFt7bmFtZTogJ+u5hOuqqCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wMS5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+y/oOq4sCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wMi5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+ygnOydtOyXoCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wMy5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+yYrOudvO2UhCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wNC5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+y9lOunpScsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wNS5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+unpey9lCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wNi5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+y9lOunpey9lCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wNy5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+unpey9lOunpScsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wOC5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+y/oOq4sOy/oCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wOS5wbmcnKX0sCiAgICAgICAgICAgICAgICB7bmFtZTogJ+uwmCcsIG9jY3VwYXRpb246ICfrp4jtlLzslYQnLCBzcmM6IHJlcXVpcmUoJy4uL2Fzc2V0cy9wMTAucG5nJyl9LCAvLyDthYzsiqTtirgg642w7J207YSwCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIHJvb21JZDogdGhpcy4kcm91dGUucGFyYW1zLmlkLAogICAgICAgICAgICBjbGllbnQ6IHt9LAogICAgICAgICAgICB1c2VySWQ6ICcnCiAgICAgICAgfQogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5jbGllbnQgPSBTdG9tcC5vdmVyKG5ldyBTb2NrSlMoJy93ZWJzb2NrZXQnKSk7CiAgICAgICAgY29uc3QgZ2FtZSA9IHRoaXM7CiAgICAgICAgZ2FtZS5jbGllbnQuY29ubmVjdCh7fSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGdhbWUuY2xpZW50LnNlbmQoJy9hcHAvcm9vbXMvJyArIGdhbWUucm9vbUlkICsgJy9tYWZpYScgKTsKICAgICAgICAgICAgZ2FtZS5jbGllbnQuc3Vic2NyaWJlKCcvdXNlci9xdWV1ZS9yb29tcy8nICsgZ2FtZS5yb29tSWQgKyAnL21hZmlhL29jY3VwYXRpb24nLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZmlhT2NjdXBhdGlvbk1lc3NhZ2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmJvZHkpLmJvZHk7CiAgICAgICAgICAgICAgICBnYW1lLnVzZXJJZCA9IG1hZmlhT2NjdXBhdGlvbk1lc3NhZ2UudXNlcklkOwogICAgICAgICAgICAgICAgYWxlcnQobWFmaWFPY2N1cGF0aW9uTWVzc2FnZS5vY2N1cGF0aW9uKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGdhbWUuY2xpZW50LnN1YnNjcmliZSgnL3RvcGljL3Jvb21zLycgKyBnYW1lLnJvb21JZCArICcvbWFmaWEvY2hhdCcsIGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgY29uc3QgbWFmaWFDaGF0TWVzc2FnZSA9IEpTT04ucGFyc2UocmVzcG9uc2UuYm9keSkuYm9keTsKCiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cobWFmaWFDaGF0TWVzc2FnZSk7CiAgICAgICAgICAgICAgICBnYW1lLmFkZE1lc3NhZ2UobWFmaWFDaGF0TWVzc2FnZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgY29uc3QgZ2FtZSA9IHRoaXM7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlbmQtbWVzc2FnZScpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZ2FtZS5zZW5kTWVzc2FnZSk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2UtY29udGVudCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJyxmdW5jdGlvbihlKXsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHsKICAgICAgICAgICAgICAgIGdhbWUuc2VuZE1lc3NhZ2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGRlc3Ryb3llZCgpIHsKICAgICAgICB0aGlzLmNsaWVudC5kaXNjb25uZWN0KCk7CiAgICAgICAgLy9UT0RPOiDrp4jtlLzslYQg7LC46rCA7J6QIOuCmOqwgOuKlCDqsr3smrAKICAgIH0KfQo="},{"version":3,"sources":["Mafia.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Mafia.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <v-container id=\"mafia-app\" fluid>\n        <v-row>\n            <v-col cols=\"6\">\n                <v-row align='center' justify='center'>\n                    <MafiaCitizen :citizen=\"citizen\" :key=\"citizen.name\" v-for='citizen in citizens'/>\n                </v-row>\n            </v-col>\n            <div>\n                <div id=\"message-area\">\n                </div>\n                <div id=\"message-footer\">\n                    <input type=\"text\" id=\"message-content\">\n                    <input type=\"submit\" id=\"send-message\" value=\"전송\">\n                </div>\n            </div>\n        </v-row>\n    </v-container>\n</template>\n\n\n<script>\n    import MafiaCitizen from \"../components/MafiaCitizen\";\n    import SockJS from \"sockjs-client\";\n    import Stomp from \"webstomp-client\";\n\n    export default {\n        name: 'Mafia',\n        components: {\n            MafiaCitizen,\n        },\n        methods: {\n            messageTemplate(mafiaChatMessage) {\n                if(mafiaChatMessage.userId === this.userId){\n                    return `<div id=\"message\" style=\"text-align: right\">\n                            <span>나: ${mafiaChatMessage.message}</span>\n                    </div>`;\n                }\n                return `<div id=\"message\" style=\"text-align: left\">\n                            <span>${mafiaChatMessage.name}: ${mafiaChatMessage.message}</span>\n                    </div>`\n            },\n          sendMessage: function() {\n              const game = this;\n              const content = document.getElementById(\"message-content\").value;\n              game.client.send('/app/rooms/' + this.roomId + '/mafia/chat', content);\n              if (content.length != 0) {\n                  document.getElementById(\"message-content\").value = \"\";\n              }\n          },\n          addMessage: function(mafiaChatMessage) {\n                const messageArea = document.getElementById(\"message-area\");\n                messageArea.insertAdjacentHTML(\"beforeend\", this.messageTemplate(mafiaChatMessage));\n                messageArea.scrollTop = messageArea.scrollHeight;\n              }\n        },\n        data() {\n            return {\n                citizens: [{name: '비모', occupation: '마피아', src: require('../assets/p1.png')},\n                    {name: '쿠기', occupation: '마피아', src: require('../assets/p2.png')},\n                    {name: '제이엠', occupation: '마피아', src: require('../assets/p3.png')},\n                    {name: '올라프', occupation: '마피아', src: require('../assets/p4.png')},\n                    {name: '코맥', occupation: '마피아', src: require('../assets/p5.png')},\n                    {name: '맥코', occupation: '마피아', src: require('../assets/p6.png')},\n                    {name: '코맥코', occupation: '마피아', src: require('../assets/p7.png')},\n                    {name: '맥코맥', occupation: '마피아', src: require('../assets/p8.png')},\n                    {name: '쿠기쿠', occupation: '마피아', src: require('../assets/p9.png')},\n                    {name: '반', occupation: '마피아', src: require('../assets/p10.png')}, // 테스트 데이터\n                ],\n                roomId: this.$route.params.id,\n                client: {},\n                userId: ''\n            }\n        },\n        created() {\n            this.client = Stomp.over(new SockJS('/websocket'));\n            const game = this;\n            game.client.connect({}, function() {\n                game.client.send('/app/rooms/' + game.roomId + '/mafia' );\n                game.client.subscribe('/user/queue/rooms/' + game.roomId + '/mafia/occupation', function (response) {\n                    const mafiaOccupationMessage = JSON.parse(response.body).body;\n                    game.userId = mafiaOccupationMessage.userId;\n                    alert(mafiaOccupationMessage.occupation);\n                });\n                game.client.subscribe('/topic/rooms/' + game.roomId + '/mafia/chat', function (response) {\n                    const mafiaChatMessage = JSON.parse(response.body).body;\n\n                    window.console.log(mafiaChatMessage);\n                    game.addMessage(mafiaChatMessage);\n                });\n            });\n        },\n        mounted() {\n            const game = this;\n            document.querySelector('#send-message').addEventListener(\"click\", game.sendMessage);\n            document.querySelector('#message-content').addEventListener('keyup',function(e){\n                if (e.keyCode === 13) {\n                    game.sendMessage();\n                }\n            });\n        },\n        destroyed() {\n            this.client.disconnect();\n            //TODO: 마피아 참가자 나가는 경우\n        }\n    }\n</script>\n\n<style scoped>\n    #message {\n        display: inline-block;\n    }\n\n    #message-area {\n        font-family: monospace;\n        border: groove white;\n        overflow: scroll;\n        height: 85%;\n        width: 550px;\n        background-color: black;\n        opacity: 0.7;\n        margin-top: 5%;\n        color:white;\n        max-width: 150%;\n        border-radius: 15px;\n    }\n\n    #message-footer {\n        font-family: monospace;\n        height: 10%;\n        border: groove white;\n        width: 550px;\n        padding: 0;\n        border-radius: 15px;\n    }\n\n    #message-content {\n        width: 90%;\n        height: 100%;\n        background-color: #7f7f7f;\n        padding: 0;\n        border: 0;\n        border-radius: 15px;\n        color: white;\n    }\n\n    #send-message {\n        width: 10%;\n        height: 100%;\n        background-color: #333333;\n        padding: 0;\n        border: 0;\n        color: white;\n        border-radius: 15px;\n    }\n</style>"]}]}