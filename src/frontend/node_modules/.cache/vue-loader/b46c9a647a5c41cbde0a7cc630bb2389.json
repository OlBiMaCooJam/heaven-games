{"remainingRequest":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/src/views/Mafia.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/src/views/Mafia.vue","mtime":1576808570913},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hyogeon/IdeaProjects/heaven-games/src/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBNYWZpYUNpdGl6ZW4gZnJvbSAiLi4vY29tcG9uZW50cy9NYWZpYUNpdGl6ZW4iOwppbXBvcnQgU29ja0pTIGZyb20gInNvY2tqcy1jbGllbnQiOwppbXBvcnQgU3RvbXAgZnJvbSAid2Vic3RvbXAtY2xpZW50IjsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdNYWZpYScsCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgTWFmaWFDaXRpemVuLAogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBtZXNzYWdlVGVtcGxhdGUobWFmaWFDaGF0TWVzc2FnZSkgewogICAgICAgICAgICBpZihtYWZpYUNoYXRNZXNzYWdlLnVzZXJJZCA9PT0gdGhpcy51c2VySWQpewogICAgICAgICAgICAgICAgcmV0dXJuIGA8ZGl2IGlkPSJtZXNzYWdlIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQiPgogICAgICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT0iYm9yZGVyLXJhZGl1czogMTVweDsgYmFja2dyb3VuZC1jb2xvcjogZGFya2dyYXk7IHdpZHRoOiAyMHB4Ij7rgpg6ICR7bWFmaWFDaGF0TWVzc2FnZS5tZXNzYWdlfTwvcD4KICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGA8ZGl2IGlkPSJtZXNzYWdlIiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdCI7PgogICAgICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT0iYm9yZGVyLXJhZGl1czogMTVweDsgYmFja2dyb3VuZC1jb2xvcjogZGFya2toYWtpOyBwYWRkaW5nOiAxcHg7IHdpZHRoOiAyMHB4Ij4ke21hZmlhQ2hhdE1lc3NhZ2UubmFtZX06ICR7bWFmaWFDaGF0TWVzc2FnZS5tZXNzYWdlfTwvcD4KICAgICAgICAgICAgICAgIDwvZGl2PmAKICAgICAgICB9LAogICAgICBzZW5kTWVzc2FnZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zdCBnYW1lID0gdGhpczsKICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWVzc2FnZS1jb250ZW50IikudmFsdWU7CiAgICAgICAgICBnYW1lLmNsaWVudC5zZW5kKCcvYXBwL3Jvb21zLycgKyB0aGlzLnJvb21JZCArICcvbWFmaWEvY2hhdCcsIGNvbnRlbnQpOwogICAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoICE9IDApIHsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWVzc2FnZS1jb250ZW50IikudmFsdWUgPSAiIjsKICAgICAgICAgIH0KICAgICAgfSwKICAgICAgYWRkTWVzc2FnZTogZnVuY3Rpb24obWFmaWFDaGF0TWVzc2FnZSkgewogICAgICAgICAgICBjb25zdCBtZXNzYWdlQXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlLWFyZWEiKTsKICAgICAgICAgICAgbWVzc2FnZUFyZWEuaW5zZXJ0QWRqYWNlbnRIVE1MKCJiZWZvcmVlbmQiLCB0aGlzLm1lc3NhZ2VUZW1wbGF0ZShtYWZpYUNoYXRNZXNzYWdlKSk7CiAgICAgICAgICAgIG1lc3NhZ2VBcmVhLnNjcm9sbFRvcCA9IG1lc3NhZ2VBcmVhLnNjcm9sbEhlaWdodDsKICAgICAgICAgIH0KICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNpdGl6ZW5zOiBbe25hbWU6ICfruYTrqqgnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDEucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfsv6DquLAnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDIucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfsoJzsnbTsl6AnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDMucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfsmKzrnbztlIQnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDQucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfsvZTrp6UnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDUucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfrp6XsvZQnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDYucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfsvZTrp6XsvZQnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDcucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfrp6XsvZTrp6UnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDgucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfsv6DquLDsv6AnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDkucG5nJyl9LAogICAgICAgICAgICAgICAge25hbWU6ICfrsJgnLCBvY2N1cGF0aW9uOiAn66eI7ZS87JWEJywgc3JjOiByZXF1aXJlKCcuLi9hc3NldHMvcDEwLnBuZycpfSwgLy8g7YWM7Iqk7Yq4IOuNsOydtO2EsAogICAgICAgICAgICBdLAogICAgICAgICAgICByb29tSWQ6IHRoaXMuJHJvdXRlLnBhcmFtcy5pZCwKICAgICAgICAgICAgY2xpZW50OiB7fSwKICAgICAgICAgICAgdXNlcklkOiAnJwogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuY2xpZW50ID0gU3RvbXAub3ZlcihuZXcgU29ja0pTKCcvd2Vic29ja2V0JykpOwogICAgICAgIGNvbnN0IGdhbWUgPSB0aGlzOwogICAgICAgIGdhbWUuY2xpZW50LmNvbm5lY3Qoe30sIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBnYW1lLmNsaWVudC5zZW5kKCcvYXBwL3Jvb21zLycgKyBnYW1lLnJvb21JZCArICcvbWFmaWEnICk7CiAgICAgICAgICAgIGdhbWUuY2xpZW50LnN1YnNjcmliZSgnL3VzZXIvcXVldWUvcm9vbXMvJyArIGdhbWUucm9vbUlkICsgJy9tYWZpYS9vY2N1cGF0aW9uJywgZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtYWZpYU9jY3VwYXRpb25NZXNzYWdlID0gSlNPTi5wYXJzZShyZXNwb25zZS5ib2R5KTsKICAgICAgICAgICAgICAgIGdhbWUudXNlcklkID0gbWFmaWFPY2N1cGF0aW9uTWVzc2FnZS51c2VySWQ7CiAgICAgICAgICAgICAgICBhbGVydChtYWZpYU9jY3VwYXRpb25NZXNzYWdlLm9jY3VwYXRpb24pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZ2FtZS5jbGllbnQuc3Vic2NyaWJlKCcvdG9waWMvcm9vbXMvJyArIGdhbWUucm9vbUlkICsgJy9tYWZpYS9jaGF0JywgZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtYWZpYUNoYXRNZXNzYWdlID0gSlNPTi5wYXJzZShyZXNwb25zZS5ib2R5KTsKCiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cobWFmaWFDaGF0TWVzc2FnZSk7CiAgICAgICAgICAgICAgICBnYW1lLmFkZE1lc3NhZ2UobWFmaWFDaGF0TWVzc2FnZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgY29uc3QgZ2FtZSA9IHRoaXM7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlbmQtbWVzc2FnZScpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZ2FtZS5zZW5kTWVzc2FnZSk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2UtY29udGVudCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJyxmdW5jdGlvbihlKXsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHsKICAgICAgICAgICAgICAgIGdhbWUuc2VuZE1lc3NhZ2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGRlc3Ryb3llZCgpIHsKICAgICAgICB0aGlzLmNsaWVudC5kaXNjb25uZWN0KCk7CiAgICAgICAgLy9UT0RPOiDrp4jtlLzslYQg7LC46rCA7J6QIOuCmOqwgOuKlCDqsr3smrAKICAgIH0KfQo="},{"version":3,"sources":["Mafia.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Mafia.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <v-container id=\"mafia-app\" fluid>\n        <v-row>\n            <v-col cols=\"6\">\n                <v-row align='center' justify='center'>\n                    <MafiaCitizen :citizen=\"citizen\" :key=\"citizen.name\" v-for='citizen in citizens'/>\n                </v-row>\n            </v-col>\n            <div>\n                <div id=\"message-area\">\n                </div>\n                <div id=\"message-footer\">\n                    <input type=\"text\" id=\"message-content\">\n                    <input type=\"submit\" id=\"send-message\" value=\"전송\">\n                </div>\n            </div>\n        </v-row>\n    </v-container>\n</template>\n\n\n<script>\n    import MafiaCitizen from \"../components/MafiaCitizen\";\n    import SockJS from \"sockjs-client\";\n    import Stomp from \"webstomp-client\";\n\n    export default {\n        name: 'Mafia',\n        components: {\n            MafiaCitizen,\n        },\n        methods: {\n            messageTemplate(mafiaChatMessage) {\n                if(mafiaChatMessage.userId === this.userId){\n                    return `<div id=\"message\" style=\"text-align: right\">\n                            <p style=\"border-radius: 15px; background-color: darkgray; width: 20px\">나: ${mafiaChatMessage.message}</p>\n                    </div>`;\n                }\n                return `<div id=\"message\" style=\"text-align: left\";>\n                            <p style=\"border-radius: 15px; background-color: darkkhaki; padding: 1px; width: 20px\">${mafiaChatMessage.name}: ${mafiaChatMessage.message}</p>\n                    </div>`\n            },\n          sendMessage: function() {\n              const game = this;\n              const content = document.getElementById(\"message-content\").value;\n              game.client.send('/app/rooms/' + this.roomId + '/mafia/chat', content);\n              if (content.length != 0) {\n                  document.getElementById(\"message-content\").value = \"\";\n              }\n          },\n          addMessage: function(mafiaChatMessage) {\n                const messageArea = document.getElementById(\"message-area\");\n                messageArea.insertAdjacentHTML(\"beforeend\", this.messageTemplate(mafiaChatMessage));\n                messageArea.scrollTop = messageArea.scrollHeight;\n              }\n        },\n        data() {\n            return {\n                citizens: [{name: '비모', occupation: '마피아', src: require('../assets/p1.png')},\n                    {name: '쿠기', occupation: '마피아', src: require('../assets/p2.png')},\n                    {name: '제이엠', occupation: '마피아', src: require('../assets/p3.png')},\n                    {name: '올라프', occupation: '마피아', src: require('../assets/p4.png')},\n                    {name: '코맥', occupation: '마피아', src: require('../assets/p5.png')},\n                    {name: '맥코', occupation: '마피아', src: require('../assets/p6.png')},\n                    {name: '코맥코', occupation: '마피아', src: require('../assets/p7.png')},\n                    {name: '맥코맥', occupation: '마피아', src: require('../assets/p8.png')},\n                    {name: '쿠기쿠', occupation: '마피아', src: require('../assets/p9.png')},\n                    {name: '반', occupation: '마피아', src: require('../assets/p10.png')}, // 테스트 데이터\n                ],\n                roomId: this.$route.params.id,\n                client: {},\n                userId: ''\n            }\n        },\n        created() {\n            this.client = Stomp.over(new SockJS('/websocket'));\n            const game = this;\n            game.client.connect({}, function() {\n                game.client.send('/app/rooms/' + game.roomId + '/mafia' );\n                game.client.subscribe('/user/queue/rooms/' + game.roomId + '/mafia/occupation', function (response) {\n                    const mafiaOccupationMessage = JSON.parse(response.body);\n                    game.userId = mafiaOccupationMessage.userId;\n                    alert(mafiaOccupationMessage.occupation);\n                });\n                game.client.subscribe('/topic/rooms/' + game.roomId + '/mafia/chat', function (response) {\n                    const mafiaChatMessage = JSON.parse(response.body);\n\n                    window.console.log(mafiaChatMessage);\n                    game.addMessage(mafiaChatMessage);\n                });\n            });\n        },\n        mounted() {\n            const game = this;\n            document.querySelector('#send-message').addEventListener(\"click\", game.sendMessage);\n            document.querySelector('#message-content').addEventListener('keyup',function(e){\n                if (e.keyCode === 13) {\n                    game.sendMessage();\n                }\n            });\n        },\n        destroyed() {\n            this.client.disconnect();\n            //TODO: 마피아 참가자 나가는 경우\n        }\n    }\n</script>\n\n<style scoped>\n    #message {\n        display: inline-block;\n    }\n\n    #message-area {\n        font-family: monospace;\n        border: groove white;\n        overflow: scroll;\n        height: 85%;\n        width: 550px;\n        background-color: black;\n        opacity: 0.7;\n        margin-top: 5%;\n        color:white;\n        max-width: 150%;\n        border-radius: 15px;\n    }\n\n    #message-footer {\n        font-family: monospace;\n        height: 10%;\n        border: groove white;\n        width: 550px;\n        padding: 0;\n        border-radius: 15px;\n    }\n\n    #message-content {\n        width: 90%;\n        height: 100%;\n        background-color: #7f7f7f;\n        padding: 0;\n        border: 0;\n        border-radius: 15px;\n        color: white;\n        display: inline-block;\n\n    }\n\n    #send-message {\n        width: 10%;\n        height: 100%;\n        background-color: #333333;\n        padding: 0;\n        border: 0;\n        color: white;\n        border-radius: 15px;\n    }\n</style>"]}]}